<div class="grid-view-overlay">
  <div class="grid-card">
    <div class="grid-header">
      <div class="header-info">
        <h2>Detalle de Movimientos</h2>
        <span class="subtitle">{{ selectedMonth() | date:'MMMM yyyy' }} - {{ selectedAccount() | uppercase }}</span>
      </div>
      <div class="header-actions">
        <button class="export-btn" (click)="onExport()">üì• Exportar a Excel</button>
        <button class="close-btn" (click)="onClose()">Volver al Dashboard</button>
      </div>
    </div>

    <div class="table-container">
      <table class="transactions-table">
        <thead>
          <tr>
            <th>Fecha</th>
            <th>Concepto</th>
            <th>Categor√≠a</th>
            <th>Notas / Comentarios</th>
            <th class="text-right">Importe</th>
            <th class="text-center">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let t of monthlyTransactions()" 
              [class.income-row]="t.type === 'income'" 
              [class.expense-row]="t.type === 'expense'"
              (click)="onSelect(t)"
              class="clickable-row">
            <td class="date-col">{{ t.date | date:'dd/MM/yyyy' }}</td>
            <td class="title-col">
              <div class="title-content">
                <span class="type-indicator" [class.income]="t.type === 'income'" [class.expense]="t.type === 'expense'"></span>
                {{ t.title }}
              </div>
            </td>
            <td class="category-col">
              <span class="category-pill">
                {{ icons[t.category] }} {{ t.category }}
              </span>
            </td>
            <td class="comment-col">
              <div class="comment-display">
                {{ t.comment || '---' }}
              </div>
            </td>
            <td class="amount-col text-right" [class.positive]="t.type === 'income'" [class.negative]="t.type === 'expense'">
              {{ t.type === 'income' ? '+' : '-' }}{{ t.amount | currency:'EUR' }}
            </td>
            <td class="actions-col text-center">
              <button class="delete-row-btn" (click)="confirmDelete(t.id, $event)">üóëÔ∏è</button>
            </td>
          </tr>
          <tr *ngIf="monthlyTransactions().length === 0">
            <td colspan="6" class="empty-table">No hay movimientos en este periodo.</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Deletion Confirmation Modal -->
  <div class="confirm-overlay" *ngIf="transactionToDelete()" (click)="cancelDelete()">
    <div class="confirm-modal" (click)="$event.stopPropagation()">
      <div class="confirm-icon">‚ö†Ô∏è</div>
      <h4>¬øEliminar movimiento?</h4>
      <p>Esta acci√≥n no se puede deshacer.</p>
      <div class="confirm-actions">
        <button class="btn-cancel" (click)="cancelDelete()">Cancelar</button>
        <button class="btn-confirm" (click)="executeDelete()">Eliminar</button>
      </div>
    </div>
  </div>
</div>
